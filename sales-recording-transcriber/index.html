<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>営業録画 文字起こしAI | Sales Recording Transcriber</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- ヘッダー -->
        <header class="header">
            <div class="logo">
                <i class="fas fa-microphone-lines"></i>
                <h1>営業録画 文字起こしAI</h1>
            </div>
            <p class="tagline">MP3またはYouTubeリンクから話者を識別して自動文字起こし</p>
        </header>

        <!-- API設定セクション -->
        <section class="api-section">
            <div class="section-header">
                <i class="fas fa-key"></i>
                <h2>API設定</h2>
            </div>
            <div class="api-input-group">
                <label for="apiKey">OpenAI API Key</label>
                <div class="input-wrapper">
                    <input type="password" id="apiKey" placeholder="sk-..." autocomplete="off">
                    <button type="button" class="toggle-visibility" onclick="toggleApiKeyVisibility()">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <p class="hint">Whisper APIを使用して高精度な文字起こしと話者分離を行います</p>
            </div>
        </section>

        <!-- 入力方法選択 -->
        <section class="input-section">
            <div class="section-header">
                <i class="fas fa-upload"></i>
                <h2>音声データの入力</h2>
            </div>

            <div class="input-tabs">
                <button class="tab-btn active" data-tab="file">
                    <i class="fas fa-file-audio"></i>
                    MP3ファイル
                </button>
                <button class="tab-btn" data-tab="youtube">
                    <i class="fab fa-youtube"></i>
                    YouTubeリンク
                </button>
            </div>

            <!-- MP3アップロード -->
            <div class="tab-content active" id="file-tab">
                <div class="upload-area" id="dropZone">
                    <div class="upload-icon">
                        <i class="fas fa-cloud-arrow-up"></i>
                    </div>
                    <p class="upload-text">ファイルをドラッグ＆ドロップ</p>
                    <p class="upload-subtext">または</p>
                    <label for="fileInput" class="file-label">ファイルを選択</label>
                    <input type="file" id="fileInput" accept="audio/*,.mp3,.wav,.m4a,.ogg,.webm" hidden>
                    <p class="file-hint">対応形式: MP3, WAV, M4A, OGG, WebM (最大25MB)</p>
                </div>
                <div class="selected-file" id="selectedFile" style="display: none;">
                    <i class="fas fa-file-audio"></i>
                    <span id="fileName"></span>
                    <button class="remove-file" onclick="removeFile()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- YouTubeリンク入力 -->
            <div class="tab-content" id="youtube-tab">
                <div class="youtube-input-area">
                    <div class="youtube-icon">
                        <i class="fab fa-youtube"></i>
                    </div>
                    <input type="text" id="youtubeUrl" placeholder="https://www.youtube.com/watch?v=...">
                    <p class="youtube-hint">YouTubeの動画URLを入力してください</p>
                </div>
            </div>
        </section>

        <!-- 話者設定 -->
        <section class="speaker-section">
            <div class="section-header">
                <i class="fas fa-users"></i>
                <h2>話者設定</h2>
            </div>
            <div class="speaker-settings">
                <div class="speaker-card speaker-1">
                    <div class="speaker-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="speaker-info">
                        <label for="speaker1Name">話者1（営業担当）</label>
                        <input type="text" id="speaker1Name" placeholder="例: 山田">
                    </div>
                </div>
                <div class="speaker-card speaker-2">
                    <div class="speaker-avatar">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <div class="speaker-info">
                        <label for="speaker2Name">話者2（顧客）</label>
                        <input type="text" id="speaker2Name" placeholder="例: 佐藤様">
                    </div>
                </div>
            </div>
        </section>

        <!-- 実行ボタン -->
        <div class="action-area">
            <button class="transcribe-btn" id="transcribeBtn" onclick="startTranscription()">
                <i class="fas fa-wand-magic-sparkles"></i>
                文字起こしを開始
            </button>
        </div>

        <!-- 処理状態表示 -->
        <section class="progress-section" id="progressSection" style="display: none;">
            <div class="progress-card">
                <div class="progress-spinner">
                    <div class="spinner"></div>
                </div>
                <div class="progress-info">
                    <h3 id="progressTitle">処理中...</h3>
                    <p id="progressText">音声を解析しています</p>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p class="progress-percent" id="progressPercent">0%</p>
            </div>
        </section>

        <!-- 結果表示 -->
        <section class="result-section" id="resultSection" style="display: none;">
            <div class="section-header">
                <i class="fas fa-file-lines"></i>
                <h2>文字起こし結果</h2>
            </div>

            <!-- 統計情報 -->
            <div class="stats-grid">
                <div class="stat-card">
                    <i class="fas fa-clock"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="totalDuration">00:00</span>
                        <span class="stat-label">合計時間</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-comment-dots"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="totalSegments">0</span>
                        <span class="stat-label">発言数</span>
                    </div>
                </div>
                <div class="stat-card speaker-1-stat">
                    <i class="fas fa-user"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="speaker1Time">00:00</span>
                        <span class="stat-label" id="speaker1Label">話者1</span>
                    </div>
                </div>
                <div class="stat-card speaker-2-stat">
                    <i class="fas fa-user-tie"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="speaker2Time">00:00</span>
                        <span class="stat-label" id="speaker2Label">話者2</span>
                    </div>
                </div>
            </div>

            <!-- アクションボタン -->
            <div class="result-actions">
                <button class="action-btn" onclick="copyToClipboard()">
                    <i class="fas fa-copy"></i>
                    コピー
                </button>
                <button class="action-btn" onclick="downloadAsText()">
                    <i class="fas fa-download"></i>
                    TXT
                </button>
                <button class="action-btn" onclick="downloadAsCSV()">
                    <i class="fas fa-file-csv"></i>
                    CSV
                </button>
                <button class="action-btn" onclick="downloadAsJSON()">
                    <i class="fas fa-code"></i>
                    JSON
                </button>
            </div>

            <!-- 会話ログ -->
            <div class="transcript-container" id="transcriptContainer">
                <!-- 動的に生成される -->
            </div>
        </section>

        <!-- フッター -->
        <footer class="footer">
            <p>営業録画 文字起こしAI &copy; 2024</p>
            <p class="footer-note">OpenAI Whisper APIを使用しています</p>
        </footer>
    </div>

    <!-- トースト通知 -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">コピーしました</span>
    </div>

    <script src="app.js"></script>
</body>
</html>
